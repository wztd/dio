!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TypeIt=t()}(this,function(){"use strict";const t=e=>Array.isArray(e),I=e=>t(e)?e:[e],M=e=>Array.from(e),x=e=>document.createTextNode(e);let A=e=>([...e.childNodes].forEach(t=>{if(t.nodeValue)return[...t.nodeValue].forEach(e=>{t.parentNode.insertBefore(x(e),t)}),void t.remove();A(t)}),e);const H=e=>{let t=document.implementation.createHTMLDocument();return t.body.innerHTML=e,A(t.body)},O="ti-cursor",F={started:!1,completed:!1,frozen:!1,destroyed:!1},k={breakLines:!0,cursor:{autoPause:!0,autoPauseDelay:500,animation:{frames:[0,0,1].map(e=>({opacity:e})),options:{iterations:1/0,easing:"steps(2, start)",fill:"forwards"}}},cursorChar:"|",cursorSpeed:1e3,deleteSpeed:null,html:!0,lifeLike:!0,loop:!1,loopDelay:750,nextStringDelay:750,speed:100,startDelay:250,startDelete:!1,strings:[],waitUntilVisible:!1,beforeString:()=>{},afterString:()=>{},beforeStep:()=>{},afterStep:()=>{},afterComplete:()=>{}};function R(e,t=!1,r=!1){let n,a=e.querySelector(".ti-cursor"),i=document.createTreeWalker(e,NodeFilter.SHOW_ALL,{acceptNode:e=>{if(a&&r){if(e.classList?.contains(O))return NodeFilter.FILTER_ACCEPT;if(a.contains(e))return NodeFilter.FILTER_REJECT}return e.classList?.contains(O)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),o=[];for(;n=i.nextNode();)n.originalParent||(n.originalParent=n.parentNode),o.push(n);return t?o.reverse():o}const q=e=>document.createElement(e),z=(e,t="")=>{let r=q("style");r.id=t,r.appendChild(x(e)),document.head.appendChild(r)},B=e=>e=t(e)?e:[e/2,e/2],$=(e,t)=>Math.abs(Math.random()*(e+t-(e-t))+(e-t));const _=e=>"value"in e;let j=e=>"function"==typeof e?e():e;const V=e=>Number.isInteger(e);let Q=(e,t=document,r=!1)=>t["querySelector"+(r?"All":"")](e);const J=(e,t)=>Object.assign({},e,t);let U={"font-family":"","font-weight":"","font-size":"","font-style":"","line-height":"",color:"",transform:"translateX(-.125em)"};const W=(e,t)=>new Array(t).fill(e),X=({queueItems:e,selector:n,cursorPosition:t,to:r})=>{if(V(n))return-1*n;let a=new RegExp("END","i").test(r),i=n?[...e].reverse().findIndex(({char:e})=>{let t=e.parentElement,r=t.matches(n);return!(!a||!r)||r&&t.firstChild.isSameNode(e)}):-1;return(i=i<0?a?0:e.length-1:i)-t+(a?0:1)};let G=t=>new Promise(e=>{requestAnimationFrame(async()=>{e(await t())})}),K=t=>t?.getAnimations().find(e=>e.id===t.dataset.tiAnimationId),Y=({cursor:e,frames:t,options:r})=>{let n=e.animate(t,r);return n.pause(),n.id=e.dataset.tiAnimationId,G(()=>{G(()=>{n.play()})}),n},Z=e=>e.func?.call(null);return function(e,t={}){let l=async(e,t,r=!1)=>{var n,a,i;P.frozen&&await new Promise(e=>{this.unfreeze=()=>{P.frozen=!1,e()}}),r||await S.beforeStep(this),n=e,a=t,i=T,await new Promise(e=>{i.push(setTimeout(async()=>{await n(),e()},a||0))}),r||await S.afterStep(this)},u=(e,t)=>(async({index:e,queueItems:t,wait:r,cursor:n,cursorOptions:a})=>{let i=t[e][1],o=[],s=e,l=i,u=()=>l&&!l.delay,c=i.shouldPauseCursor()&&a.autoPause;for(;u();)o.push(l),u()&&s++,l=t[s]?t[s][1]:null;if(o.length)return await G(async()=>{for(var e of o)await Z(e)}),s-1;let d,f=K(n);return f&&(d={...f.effect.getComputedTiming(),delay:c?a.autoPauseDelay:0}),await r(async()=>{f&&c&&f.cancel(),await G(()=>{Z(i)})},i.delay),await(({cursor:n,options:a,cursorOptions:i})=>{if(n&&i){let e,t=K(n),r=(t&&(a.delay=t.effect.getComputedTiming().delay,e=t.currentTime,t.cancel()),Y({cursor:n,frames:i.animation.frames,options:a}));return e&&(r.currentTime=e),r}})({cursor:n,options:d,cursorOptions:a}),e})({index:e,queueItems:t,wait:l,cursor:D,cursorOptions:S.cursor}),r=t=>{var r=v;if(t){let e=t.parentNode;(1<e.childNodes.length||e.isSameNode(r)?t:e).remove()}},n=()=>_(v),c=(e=0)=>function(){let{speed:e,deleteSpeed:t,lifeLike:r}=S;return t=null!==t?t:e/3,r?[$(e,e/2),$(t,t/2)]:[e,t]}()[e],d=()=>(e=>_(e)?M(e.value):R(e,!0).filter(e=>!(0<e.childNodes.length)))(v),f=(e,t)=>{L.add(e);var[e={}]=[t];return(e=e.delay)&&L.add({delay:e}),this},h=()=>E??w,p=(e={})=>[{func:()=>o(e)},{func:()=>o(S)}],a=e=>{var t=S.nextStringDelay;L.add([{delay:t[0]},...e,{delay:t[1]}])},i=async()=>{if(!n()&&D&&v.appendChild(D),C){{var r=N;var a=v;let e=`[data-typeit-id='${r}'] .ti-cursor`,n=getComputedStyle(a),t=Object.entries(U).reduce((e,[t,r])=>`${e} ${t}: var(--ti-cursor-${t}, ${r||n[t]});`,"");z(e+` { display: inline-block; width: 0; ${t} }`,r)}D.dataset.tiAnimationId=N;var a=S.cursor["animation"],{frames:r,options:a}=a;Y({frames:r,cursor:D,options:{duration:S.cursorSpeed,...a}})}},y=async(r=!0)=>{P.started=!0;let a=e=>{L.done(e,!r)};try{let t=[...L.getQueue()];for(let e=0;e<t.length;e++){var i,[o,s]=t[e];s.done||((!s.deletable||s.deletable&&d().length)&&(i=await u(e,t),Array(i-e).fill(e+1).map((e,t)=>e+t).forEach(e=>{var[e]=t[e];a(e)}),e=i),a(o))}if(!r)return this;if(P.completed=!0,await S.afterComplete(this),!S.loop)throw"";let n=S.loopDelay;l(async()=>{var e=n[0],t=h(),r=(t&&await m({value:t}),d().map(e=>[Symbol(),{func:b,delay:c(1),deletable:!0,shouldPauseCursor:()=>!0}]));for(let e=0;e<r.length;e++)await u(e,r);L.reset(),L.set(0,{delay:e}),await 0,y()},n[1])}catch(e){}return this},m=async e=>{var r=w,t=d();w=Math.min(Math.max(r+e,0),t.length);{r=v;let e=d()[w-1],t=Q(".ti-cursor",r);return void(r=e?.parentNode||r).insertBefore(t,e||null)}},g=t=>{var r,n=v;if(_(n))n.value=""+n.value+t.textContent;else{t.innerHTML="";r=t.originalParent;let e=!/body/i.test(r?.tagName)&&t.originalParent||n;e.insertBefore(t,Q(".ti-cursor",e)||null)}},o=async e=>S=J(S,e),s=async()=>{n()?v.value="":d().forEach(r)},b=()=>{var e=d();e.length&&(n()?v.value=v.value.slice(0,-1):r(e[w]))},v=(this.break=function(e){return f({func:()=>g(q("BR")),typeable:!0},e)},this.delete=function(e=null,t={}){e=j(e);var r=p(t),{instant:n,to:a}=t,i=L.getTypeable(),i=null===e?i.length:V(e)?e:X({queueItems:i,selector:e,cursorPosition:h(),to:a});return f([r[0],...W({func:b,delay:n?0:c(1),deletable:!0},i),r[1]],t)},this.empty=function(e={}){return f({func:s},e)},this.exec=function(e,t={}){var r=p(t);return f([r[0],{func:()=>e(this)},r[1]],t)},this.move=function(e,t={}){e=j(e);let r=p(t),{instant:n,to:a}=t,i=X({queueItems:L.getTypeable(),selector:null===e?"":e,to:a,cursorPosition:h()}),o=i<0?-1:1;return E=h()+i,f([r[0],...W({func:()=>m(o),delay:n?0:c(),cursorable:!0},Math.abs(i)),r[1]],t)},this.options=function(e,t={}){return e=j(e),o(e),f({},t)},this.pause=function(e,t={}){return f({delay:j(e)},t)},this.type=function(e,t={}){e=j(e);let r=t["instant"],n=p(t),a=([o,s=!0]=[e,S.html],(s?R(H(o)):M(o).map(x)).map(e=>{return{func:()=>g(e),char:e,delay:r||/<(.+)>(.*?)<\/(.+)>/.test(e.outerHTML)?0:c(),typeable:e.nodeType===Node.TEXT_NODE}})),i=[n[0],{func:async()=>S.beforeString(e,this)},...a,{func:async()=>S.afterString(e,this)},n[1]];var o,s;return f(i,t)},this.is=function(e){return P[e]},this.destroy=function(e=!0){T.forEach(clearTimeout),T=[],j(e)&&D&&r(D),P.destroyed=!0},this.freeze=function(){P.frozen=!0},this.unfreeze=()=>{},this.reset=function(e){for(var t in this.is("destroyed")||this.destroy(),e?(L.wipe(),e(this)):L.reset(),w=0,P)P[t]=!1;return v[n()?"value":"innerHTML"]="",this},this.go=function(){return P.started||(i(),S.waitUntilVisible?(r=v,n=y.bind(this),new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(n(),t.unobserve(r))})},{threshold:1}).observe(r)):y()),this;var r,n},this.flush=function(e=()=>{}){return i(),y(!1).then(e),this},this.getQueue=()=>L,this.getOptions=()=>S,this.updateOptions=e=>o(e),this.getElement=()=>v,"string"==typeof(e=e)?Q(e):e);let T=[],w=0,E=null,P=J({},F),S=(t.cursor=(n=>{if("object"!=typeof n)return!0===n?k.cursor:n;{let e={},{frames:t,options:r}=k.cursor.animation;return e.animation=n.animation||{},e.animation.frames=n.animation?.frames||t,e.animation.options=J(r,n.animation?.options||{}),e.autoPause=n.autoPause??k.cursor.autoPause,e.autoPauseDelay=n.autoPauseDelay||k.cursor.autoPauseDelay,e}})(t.cursor??k.cursor),J(k,t)),N=(S=J(S,{html:!n()&&S.html,nextStringDelay:B(S.nextStringDelay),loopDelay:B(S.loopDelay)}),Math.random().toString().substring(2,9)),L=function(e){function t(e){return I(e).forEach(e=>a.set(Symbol(e.char?.innerText),n({...e}))),this}let n=e=>(e.shouldPauseCursor=function(){return Boolean(this.typeable||this.cursorable||this.deletable)},e),r=()=>Array.from(a.values()),a=new Map;return t(e),{add:t,set:function(e,t){var r=[...a.keys()];a.set(r[e],n(t))},wipe:function(){a=new Map,t(e)},reset:function(){a.forEach(e=>delete e.done)},destroy:e=>a.delete(e),done:(e,t=!1)=>t?a.delete(e):a.get(e).done=!0,getItems:(e=!1)=>e?r():r().filter(e=>!e.done),getQueue:()=>a,getTypeable:()=>r().filter(e=>e.typeable)}}([{delay:S.startDelay}]),C=(v.dataset.typeitId=N,z("[data-typeit-id]:before {content: '.'; display: inline-block; width: 0; visibility: hidden;}"),!!S.cursor&&!n()),D=(()=>{if(!n()){let e=q("span");return e.className=O,C?e.innerHTML=H(S.cursorChar).innerHTML:e.style.visibility="hidden",e}})();if(S.strings=(e=>{let t=v.innerHTML;return t?(v.innerHTML="",S.startDelete?(v.innerHTML=t,A(v),a(W({func:b,delay:c(1),deletable:!0},d().length)),e):t.replace(/<!--(.+?)-->/g,"").trim().split(/<br(?:\s*?)(?:\/)?>/).concat(e)):e})(I(S.strings)),S.strings.length){let r=S.strings.filter(e=>!!e);r.forEach((e,t)=>{this.type(e),t+1!==r.length&&(e=S.breakLines?[{func:()=>g(q("BR")),typeable:!0}]:W({func:b,delay:c(1)},L.getTypeable().length),a(e))})}}});